/* empty css                   */(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))l(t);new MutationObserver(t=>{for(const o of t)if(o.type==="childList")for(const n of o.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&l(n)}).observe(document,{childList:!0,subtree:!0});function u(t){const o={};return t.integrity&&(o.integrity=t.integrity),t.referrerPolicy&&(o.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?o.credentials="include":t.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function l(t){if(t.ep)return;t.ep=!0;const o=u(t);fetch(t.href,o)}})();document.addEventListener("DOMContentLoaded",()=>{const d=document.getElementById("phone-number-input"),a=document.getElementById("send-otp-button"),u=document.getElementById("verify-otp-button"),l=document.getElementById("otp-section"),t=document.getElementById("otp-fieldset"),o=t.querySelectorAll("input");window.recaptchaVerifier=new firebase.auth.RecaptchaVerifier("recaptcha-container",{size:"invisible",callback:n=>{console.log("reCAPTCHA solved")}}),a.addEventListener("click",()=>{const n="+91"+d.value,e=window.recaptchaVerifier;auth.signInWithPhoneNumber(n,e).then(r=>{window.confirmationResult=r,l.classList.remove("hidden"),a.parentElement.style.display="none",d.disabled=!0,o[0].focus(),alert("OTP has been sent!")}).catch(r=>{console.error("Error sending OTP: ",r),recaptchaVerifier.render().then(i=>recaptchaVerifier.reset(i)),alert("Error sending OTP. Please try again.")})}),u.addEventListener("click",()=>{const n=Array.from(document.querySelectorAll(".otp-input")).map(r=>r.value).join(""),e=document.getElementById("error-message");if(!n||n.length!==6){e.textContent="Please enter a valid 6-digit OTP.";return}confirmationResult.confirm(n).then(async r=>{const i=r.user,s=i.phoneNumber;try{(await db.collection("users").doc(i.uid).get()).exists?console.log("User already exists in database"):(await db.collection("users").doc(i.uid).set({phoneNumber:s,uid:i.uid,khatu_website_admin:!1,createdAt:firebase.firestore.FieldValue.serverTimestamp(),name:s,email:"",address:""}),console.log("New user added to Firestore database")),(await db.collection("users").doc(i.uid).get()).data().khatu_website_admin===!0?window.location.href="admin_dashboard.html":window.location.href="dashboard.html"}catch(c){console.error("Error saving user to database:",c),e.textContent="Login successful but error saving user data. Please contact support."}}).catch(r=>{e.textContent="Invalid verification code. Please try again.",console.error("Verification error:",r)})}),t.addEventListener("keyup",n=>{const e=n.target;if(n.key.match(/^\d$/))if(e.value.length>1){let i=e.value,s=e;for(let c=0;c<i.length&&s;c++)s.value=i[c],s.nextElementSibling&&(s=s.nextElementSibling);s.focus()}else e.nextElementSibling&&e.nextElementSibling.focus()}),t.addEventListener("keydown",n=>{const e=n.target,r=n.key;r==="Backspace"&&e.value===""?e.previousElementSibling&&(e.previousElementSibling.value="",e.previousElementSibling.focus()):r==="ArrowLeft"?e.previousElementSibling&&e.previousElementSibling.focus():r==="ArrowRight"&&e.nextElementSibling&&e.nextElementSibling.focus()})});
