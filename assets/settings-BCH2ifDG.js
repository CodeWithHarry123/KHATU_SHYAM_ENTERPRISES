import{o as k,d as m,b as u,g as w,a as g,s as I,u as S}from"./firebase-init-CdBNjGdT.js";/* empty css                   *//* empty css              */import"./lazy-loader-CPsUXe95.js";document.addEventListener("DOMContentLoaded",()=>{let a=null;const h=document.getElementById("logout-button"),f=document.getElementById("sidebar"),p=document.getElementById("sidebar-toggle"),c=document.querySelectorAll(".tab-button"),E=document.querySelectorAll(".tab-content"),n=document.getElementById("dark-mode-toggle"),d=document.querySelector("#profile form"),r=document.querySelector('#profile input[type="text"]'),l=document.querySelector('#profile input[type="email"]');k(g,async e=>{if(e){a=e;try{const t=m(u,"users",e.uid),o=await w(t);o.exists()&&o.data().khatu_website_admin?(console.log("Admin user authenticated successfully."),y(o.data())):(ErrorHandler.show("Access Denied. You do not have permission to view this page.","error"),window.location.href="dashboard.html")}catch(t){ErrorHandler.handleFirebaseError(t),window.location.href="login.html"}}else console.log("No user logged in. Redirecting to login."),window.location.href="login.html"});function y(e){r&&(r.value=e.name||""),l&&(l.value=e.email||"")}async function v(e){if(e.preventDefault(),!a){ErrorHandler.show("You must be logged in to save changes.","error");return}const t=r.value,o=l.value;try{const s=m(u,"users",a.uid);await S(s,{name:t,email:o}),ErrorHandler.show("Profile updated successfully!","success")}catch(s){ErrorHandler.handleFirebaseError(s)}}d&&d.addEventListener("submit",v),p.addEventListener("click",()=>{f.classList.toggle("-translate-x-full")}),h.addEventListener("click",e=>{e.preventDefault(),I(g).then(()=>{window.location.href="index.html"})}),c.forEach(e=>{e.addEventListener("click",()=>{c.forEach(t=>t.classList.remove("active","bg-primary/10","text-primary")),E.forEach(t=>t.classList.add("hidden")),e.classList.add("active","bg-primary/10","text-primary"),document.getElementById(e.dataset.tab).classList.remove("hidden")})}),localStorage.getItem("color-theme")==="dark"?(document.documentElement.classList.add("dark"),n.checked=!0):(document.documentElement.classList.remove("dark"),n.checked=!1),n.addEventListener("change",function(){localStorage.getItem("color-theme")?localStorage.getItem("color-theme")==="light"?(document.documentElement.classList.add("dark"),localStorage.setItem("color-theme","dark")):(document.documentElement.classList.remove("dark"),localStorage.setItem("color-theme","light")):document.documentElement.classList.contains("dark")?(document.documentElement.classList.remove("dark"),localStorage.setItem("color-theme","light")):(document.documentElement.classList.add("dark"),localStorage.setItem("color-theme","dark"))});const i=new BackupSystem,L=document.getElementById("export-data-button"),b=document.getElementById("import-data-input");L.addEventListener("click",()=>{i.exportAllData()}),b.addEventListener("change",e=>{const t=e.target.files[0];t&&confirm("Are you sure you want to import data? This will overwrite existing data and cannot be undone.")&&i.importData(t)}),LazyLoader.init()});
