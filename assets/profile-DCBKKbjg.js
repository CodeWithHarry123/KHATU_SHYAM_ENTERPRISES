import{o as C,d as A,b as N,g as D,u as k,a as E,s as P}from"./firebase-init-C-AE0vWN.js";/* empty css                   */import"./lazy-loader-CPsUXe95.js";function a(l,s="info"){const i=document.getElementById("toast-container");if(!i)return;const c={success:"bg-green-500",error:"bg-red-500",warning:"bg-yellow-500",info:"bg-blue-500"},d={success:"✓",error:"✗",warning:"⚠",info:"ℹ"},o=document.createElement("div");o.className=`${c[s]} text-white px-6 py-4 rounded-lg shadow-lg flex items-center space-x-3 animate-slide-in`,o.innerHTML=`
        <span class="text-2xl">${d[s]}</span>
        <span class="font-medium">${l}</span>
        <button onclick="this.parentElement.remove()" class="ml-4 text-white hover:text-gray-200">✕</button>
    `,i.appendChild(o),setTimeout(()=>{o.classList.add("animate-slide-out"),setTimeout(()=>o.remove(),300)},5e3)}document.addEventListener("DOMContentLoaded",()=>{const l=document.getElementById("logout-button"),s=document.getElementById("mobile-logout-button"),i=document.getElementById("mobile-menu-button"),c=document.getElementById("mobile-menu"),d=document.getElementById("display-name"),o=document.getElementById("user-phone"),u=document.getElementById("user-avatar-initial"),p=document.getElementById("name-input"),f=document.getElementById("address-input"),h=document.getElementById("pincode-input"),y=document.getElementById("phone-number-display"),I=document.getElementById("member-since-display"),x=document.getElementById("save-profile-button");C(E,r=>{if(r){let m=function(n,e){let t=n.trim();return e==="name"&&(t=t.replace(/[^a-zA-Z\s]/g,""),t.length<2)?{valid:!1,message:"Name must be at least 2 characters"}:e==="address"&&(t=t.replace(/<script>/gi,""),t.length<5)?{valid:!1,message:"Address is too short"}:e==="pincode"&&(t=t.replace(/[^0-9]/g,""),t.length!==6)?{valid:!1,message:"PIN code must be 6 digits"}:{valid:!0,value:t}};const b=A(N,"users",r.uid);D(b).then(n=>{if(n.exists()){const e=n.data();d.textContent=e.name||"New User",o.textContent=r.phoneNumber,y.textContent=r.phoneNumber,p.value=e.name||"",f.value=e.address||"",h.value=e.pincode||"",e.name?u.textContent=e.name.charAt(0).toUpperCase():u.textContent="?",e.createdAt&&(I.textContent=e.createdAt.toDate().toLocaleDateString())}else window.location.href="login.html"}),x.addEventListener("click",()=>{const n=m(p.value,"name");if(!n.valid){a(n.message,"error");return}const e=m(f.value,"address");if(!e.valid){a(e.message,"error");return}const t=m(h.value,"pincode");if(!t.valid){a(t.message,"error");return}const g=n.value,B=e.value,w=t.value;k(b,{name:g,address:B,pincode:w}).then(()=>{a("Profile updated successfully!","success"),d.textContent=g,u.textContent=g.charAt(0).toUpperCase()}).catch(L=>{console.error("Error updating profile: ",L),a("Error updating profile.","error")})})}else window.location.href="login.html"});function v(){P(E).then(()=>{window.location.href="index.html"})}l.addEventListener("click",v),s&&s.addEventListener("click",v),i.addEventListener("click",()=>{c.classList.toggle("hidden")}),LazyLoader.init()});
